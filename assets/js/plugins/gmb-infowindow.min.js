function GMB_InfoWindow(){this.extend(GMB_InfoWindow,google.maps.OverlayView),this.container=jQuery('<div class="gmb-infobubble"><div class="gmb-infobubble__header"><div class="gmb-infobubble__close">Ã—</div></div><div class="gmb-infobubble__window"><div class="gmb-infobubble__content"></div></div><div class="gmb-infobubble__arrow"></div></div>'),this.layer=null,this.marker=null,this.position=null}window.GMB_InfoWindow=GMB_InfoWindow,GMB_InfoWindow.prototype.extend=function(o,t){return function(o){for(var t in o.prototype)this.prototype[t]=o.prototype[t];return this}.apply(o,[t])},GMB_InfoWindow.prototype.onAdd=function(){this.layer=jQuery(this.getPanes().floatPane),this.layer.append(this.container),this.container.find(".gmb-infobubble__close").on("click",_.bind(function(){this.close()},this)),this.addEvents_(),google.maps.event.trigger(this,"domready")},GMB_InfoWindow.prototype.onAdd=GMB_InfoWindow.prototype.onAdd,GMB_InfoWindow.prototype.draw=function(){var o=this.getProjection();if(o){var t=0;0!==this.marker.anchorPoint.x&&(t-=this.marker.anchorPoint.x);var n=this.container.outerHeight(),i=this.container.outerWidth()/2;this.position=o.fromLatLngToDivPixel(this.marker.get("position")),console.log("anchorX: "+this.marker.anchorPoint.x),console.log("anchorY: "+this.marker.anchorPoint.y),console.log("height: "+n),console.log("width: "+i),console.log("position: "+this.position),this.container.css({top:this.position.y-n+this.marker.anchorPoint.y+"px",left:this.position.x-i-t/2+"px"}),!1===this.redrawn?(console.log("redrawing----------------------"),this.redrawn=!0,this.draw()):(console.log("it was already redrawn"),console.log("==============================="),this.redrawn=!1)}},GMB_InfoWindow.prototype.draw=GMB_InfoWindow.prototype.draw,GMB_InfoWindow.prototype.onRemove=function(){this.container.remove()},GMB_InfoWindow.prototype.onRemove=GMB_InfoWindow.prototype.onRemove,GMB_InfoWindow.prototype.setContent=function(o){this.container.find(".gmb-infobubble__content").html(o)},GMB_InfoWindow.prototype.setContent=GMB_InfoWindow.prototype.setContent,GMB_InfoWindow.prototype.setAnchor=function(o){o?(this.set("anchor",o),this.bindTo("anchorPoint",o),this.bindTo("position",o)):this.get("anchor")&&(this.set("anchor",null),this.unbind("anchorPoint"),this.unbind("position"))},GMB_InfoWindow.prototype.setAnchor=GMB_InfoWindow.prototype.setAnchor,GMB_InfoWindow.prototype.setPosition=function(o){o&&(this.setAnchor(null),this.set("position",o))},GMB_InfoWindow.prototype.setPosition=GMB_InfoWindow.prototype.setPosition,GMB_InfoWindow.prototype.open=function(o,t){this.marker=t,this.setMap(o),GMB_InfoWindow.prototype.setPosition(123)},GMB_InfoWindow.prototype.open=GMB_InfoWindow.prototype.open,GMB_InfoWindow.prototype.close=function(){this.setMap(null)},GMB_InfoWindow.prototype.close=GMB_InfoWindow.prototype.close,GMB_InfoWindow.prototype.panToView=function(){var o=this.getProjection();if(o&&this.container){var t=this.marker.anchorPoint.y,n=this.container.offsetHeight+t,i=this.get("map"),e=i.getDiv(),r=e.offsetHeight,s=this.marker.getPosition(),p=o.fromLatLngToContainerPixel(i.getCenter()),a=o.fromLatLngToContainerPixel(s),d=p.y-n,h=r-p.y,c=d<0,l=0;c&&(d*=-1,l=(d+h)/2),a.y-=l,s=o.fromContainerPixelToLatLng(a),i.getCenter()!=s&&i.panTo(s)}},GMB_InfoWindow.prototype.addEvents_=function(){var o=["mousedown","mousemove","mouseover","mouseout","mouseup","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","dblclick","contextmenu","click"],t=this.container[0];this.listeners_=[];for(var n,i=0;n=o[i];i++)this.listeners_.push(google.maps.event.addDomListener(t,n,function(o){o.cancelBubble=!0,o.stopPropagation&&o.stopPropagation()}))},GMB_InfoWindow.prototype.addEvents_=GMB_InfoWindow.prototype.addEvents_;